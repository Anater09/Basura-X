<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Exploración Urbana</title>
<link rel="stylesheet" href="../css/estilos.css" />

  <style>
    .exploracion {
      margin-bottom: 40px;
      padding: 20px;
      border: 2px solid #ccc;
      border-radius: 10px;
      background-color: #fafafa;
    }

    .exploracion h2 {
      margin-bottom: 10px;
    }

    .media {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 15px;
    }

    .media img,
    .media video {
      max-width: 100%;
      border-radius: 8px;
    }

    .comentarios {
      margin-top: 30px;
      background-color: #f3f3f3;
      padding: 20px;
      border-radius: 10px;
    }

    .comentarios textarea {
      width: 100%;
      height: 100px;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    .comentarios button {
      padding: 10px 20px;
      background-color: #000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .comentarios button:hover {
      background-color: #444;
    }
  </style>
</head>
<!------- Esto es el enlace de la base de datos a la caja de comentarios ----->

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAytiZpTTTpEubyapemywSSVnRs7OfrHT0",
    authDomain: "comentarios-exploracion.firebaseapp.com",
    projectId: "comentarios-exploracion",
    storageBucket: "comentarios-exploracion.firebasestorage.app",
    messagingSenderId: "706570100799",
    appId: "1:706570100799:web:6decf184c6c5f5fb07d88a",
    databaseURL: "https://comentarios-exploracion-default-rtdb.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
</script>


<!------- Esto es el enlace de la base de datos a la caja de comentarios ----->

<!------- Esto sirve para manejar los comentarios ----->

<script type="module">
  import { getDatabase, ref, push, onValue, query, limitToLast } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const db = getDatabase();

  document.querySelectorAll('.comentarios').forEach(seccion => {
    const idSeccion = seccion.dataset.id;
    const lista = seccion.querySelector('.lista-comentarios');
    const textarea = seccion.querySelector('.comentario-textarea');
    const btnPublicar = seccion.querySelector('.btn-publicar');
    const btnVerTodos = seccion.querySelector('.btn-ver-todos');
    const comentariosRef = ref(db, 'comentarios/' + idSeccion);

    function mostrarComentarios(snapshot) {
      lista.innerHTML = "";
      const comentarios = [];
      snapshot.forEach(child => {
        comentarios.push(child.val());
      });

      comentarios.reverse().forEach(c => {
        const li = document.createElement("li");
        li.textContent = c.mensaje;
        lista.appendChild(li);
      });
    }

    const ultimosComentarios = query(comentariosRef, limitToLast(5));
    onValue(ultimosComentarios, mostrarComentarios);

    btnPublicar.addEventListener('click', () => {
      const texto = textarea.value.trim();
      if (texto) {
        push(comentariosRef, {
          mensaje: texto,
          fecha: Date.now()
        });
        textarea.value = "";
      }
    });

    btnVerTodos.addEventListener('click', () => {
      onValue(comentariosRef, mostrarComentarios, { onlyOnce: true });
      btnVerTodos.style.display = 'none';
    });
  });
</script>


<!------- Esto sirve para manejar los comentarios ----->

<body>

                  <!-- Esto es la caja de comentarios -->

<section class="exploracion">
  <h2>Exploración: Túnel abandonado</h2>
  <img src="../IMG/tunel1.jpg" alt="Foto del túnel" width="300" />
  <p>Exploramos este túnel en mayo de 2025. Oscuro, frío y perfecto para una buena historia de terror.</p>

  <!-- Caja de comentarios para esta sección -->
  <div class="comentarios" data-id="tunel">
    <h3>Comentarios recientes:</h3>
    <ul class="lista-comentarios"></ul>

    <textarea class="comentario-textarea" placeholder="Escribe tu comentario..."></textarea>
    <br>
    <button class="btn-publicar">Publicar</button>
    <button class="btn-ver-todos">Ver todos los comentarios</button>
  </div>
</section>


                  <!-- Esto es la caja de comentarios -->


  <header class="encabezado-corto">
    <div class="logo-container">
<img src="/Basura-X/IMG/MonkiFlip.gif" alt="Logo animado" />
    </div>
    <div class="info-empresa">
      <h1>Exploración Urbana</h1>
      <p>Saliendo a explorar lugares hasta que nos maten todos</p>
    </div>
    <button class="btn-login">Sección para los gordos</button>
  </header>

  <nav>
    <ul>
      <li><a href="../index.html">Inicio</a></li>
      <li><a href="exploracion.html">Exploración Urbana</a></li>
      <li><a href="piss.html">Piss in random sites</a></li>
      <li><a href="musica.html">Música</a></li>
      <li><a href="shitposting.html">Shitposting</a></li>
      <li><a href="videojuegos.html">Videojuegos</a></li>
    </ul>
  </nav>

  <main class="contenedor">
    <!-- Exploración 1 -->
    <section class="exploracion">
      <h2>Exploración #1: Hospital abandonado</h2>
      <p>Una visita nocturna a un antiguo hospital militar olvidado desde los años 90.</p>
      <div class="media">
        <img src="../img/hospital1.jpg" alt="Foto hospital 1">
        <video controls width="320">
          <source src="../videos/hospital1.mp4" type="video/mp4">
          Tu navegador no soporta video.
        </video>
 
      </div>
    </section>

    <!-- Exploración 2 -->
    <section class="exploracion">
      <h2>Exploración #2: Fábrica en ruinas</h2>
      <p>En esta exploración, entramos a una antigua planta procesadora de azúcar.</p>
      <div class="media">
        <img src="../img/fabrica1.jpg" alt="Foto fábrica 1">
        <video controls width="320">
          <source src="../videos/fabrica1.mp4" type="video/mp4">
          Tu navegador no soporta video.
        </video>
      </div>
    </section>

    <!-- Comentarios -->
    <section class="comentarios">
      <h3>Deja un comentario</h3>
      <form>
        <textarea placeholder="Escribe tu comentario aquí..."></textarea>
        <br />
        <button type="submit">Enviar</button>
      </form>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Axel R. | Exploraciones sin sentido pero con estilo</p>
  </footer>

</body>
</html>
